:root{
  --bg1:#fff7fb; --bg2:#ffeef7;
  --ink:#2b1c32;
  --accent:#ff6aa2;
  --accent-2:#ffb86c;
  --accent-3:#8be0ff;
  --accent-4:#a7f0c0;
  --panel:#ffffffee;
  --border:#ffe2f0;
  --overlay:#000000b0;
  --muted:#6c3b74;
  font-family: "Poppins", system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
}

/* Small-viewport units for mobile address bars */
html, body {
  height: 100%;
  min-height: 100svh;
  overflow: hidden; /* page itself doesn‚Äôt scroll */
  touch-action: manipulation;
  -webkit-overflow-scrolling: auto;
}

*{box-sizing:border-box;margin:0;padding:0}
body{
  display:flex;justify-content:center;align-items:center;flex-direction:column;
  min-height:100svh;text-align:center;
  background:
    radial-gradient(900px 600px at 10% 80%, rgba(255,106,162,0.10), transparent 35%),
    radial-gradient(600px 400px at 90% 10%, rgba(139,224,255,0.12), transparent 40%),
    linear-gradient(180deg,var(--bg1),var(--bg2));
  animation:bgShift 20s ease-in-out infinite alternate;
}
@keyframes bgShift{0%{ filter:hue-rotate(0deg) }100%{ filter:hue-rotate(18deg) }}

main{
  width:100%;
  max-width:980px;
  display:flex;flex-direction:column;align-items:center;gap:30px;
  padding:24px 20px;
  min-height:calc(100svh - 44px);   /* below marquee */
}

/* Marquee */
.marquee{position:fixed;top:0;left:0;right:0;height:44px;background:#ff6aa2;color:#fff;z-index:1400;box-shadow:0 6px 22px rgba(255,106,162,.35)}
.marquee__inner{display:flex;width:max-content;gap:80px;animation:scroll 18s linear infinite;white-space:nowrap;font-weight:800;letter-spacing:.4px;padding:10px 0 0 6vw}
@keyframes scroll{100%{transform:translateX(-50%)}}

/* FX layers (non interactive) */
.fx{position:fixed;inset:0;pointer-events:none}
.fireworks{z-index:100}
.twinkles{z-index:10;background:
  radial-gradient(1px 1px at 10% 20%, rgba(255,255,255,.9), transparent 60%),
  radial-gradient(1px 1px at 30% 80%, rgba(255,255,255,.9), transparent 60%),
  radial-gradient(1px 1px at 70% 40%, rgba(255,255,255,.9), transparent 60%),
  radial-gradient(1.5px 1.5px at 90% 70%, rgba(255,255,255,1), transparent 60%);
  animation:twinkle 4s linear infinite;
}
@keyframes twinkle{50%{opacity:.3; filter:blur(.3px)}100%{opacity:.8; filter:blur(0)}}
.emoji-rain{z-index:20;overflow:hidden}
.emoji-rain::before{
  content:"üéâ üéÇ üéà üíñ üéÅ ‚ú® üéä üç∞ ü•≥";
  position:absolute; left:0; right:0; top:-10%;
  display:block; text-align:center; font-size:28px; line-height:1.6;
  animation:emojiFall 14s linear infinite;
}
@keyframes emojiFall{0%{ transform:translateY(-10%); opacity:.0 }10%{ opacity:.55 }100%{ transform:translateY(120%); opacity:.55 }}

/* Stages */
.stage{width:100%;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:22px;min-height:calc(100svh - 72px)}
.center{display:grid;place-items:center;gap:18px;transform:translateY(-2vh)}

/* Countdown donut */
.ring{width:230px;height:230px;border-radius:50%;display:grid;place-items:center;position:relative;margin-top:30px;
  background: conic-gradient(from 0deg,
      rgba(255,106,162,.35), rgba(255,184,108,.30), rgba(139,224,255,.35), rgba(167,240,192,.30), rgba(255,106,162,.35));
  box-shadow:0 0 40px rgba(255,106,162,.15) inset, 0 0 30px rgba(139,224,255,.18) inset;
}
.ring.pulse{animation:ringPulse .6s ease}
@keyframes ringPulse{50%{transform:scale(1.06)}}
.num{font-size:100px;font-weight:800;color:#ff3e89;text-shadow:0 6px 0 #fff, 0 0 22px rgba(255,62,137,.35)}
.caption{font-size:18px;color:#7a517f;font-style:italic;margin-top:8px}

/* header/buttons */
.header{display:flex;flex-direction:column;align-items:center;gap:12px;padding:12px}
.panda{width:92px;height:92px;object-fit:contain;filter:drop-shadow(0 6px 14px rgba(0,0,0,.15))}
.hero-title{font-family:'Pacifico','Brush Script MT',cursive;font-size:clamp(22px,5vw,34px);color:#b31c6b;text-shadow:0 6px 18px rgba(255,255,255,.6)}
.sub{color:#7a517f;font-size:clamp(14px,3.6vw,16px)}
.btn{padding:12px 26px;border-radius:999px;border:0;background:transparent;color:#fff;cursor:pointer;font-weight:800;margin-top:12px;transform:translateZ(0)}
.btn.neon{background:linear-gradient(90deg,#ff6aa2,#ff7fb6);box-shadow:0 12px 26px rgba(255,106,162,.30)}
.btn.pink{background:linear-gradient(90deg,#ffb86c,#ff6aa2);box-shadow:0 12px 26px rgba(255,184,108,.28)}
.btn:hover{transform:translateY(-1px) scale(1.02);transition:transform .18s}
.btn:active{transform:translateY(0) scale(.995)}

/* cake */
.cake-wrap{position:relative;display:flex;align-items:center;justify-content:center;padding:4px 0}
.cake-img{width:min(360px,78vw);height:auto;filter:drop-shadow(0 14px 32px rgba(255,106,162,.22))}
.cake-fallback{width:260px;height:190px;border-radius:18px;background:linear-gradient(#f7f2e6,#e9dfcf);display:flex;align-items:center;justify-content:center;color:#6b4b30;font-weight:700}

/* bunting */
.bunting, .album-bunting{position:relative;width:100%;height:88px;pointer-events:none;margin-bottom:2px}
.bunting::before, .album-bunting::before{
  content:"";position:absolute;left:0;right:0;top:0;height:100%;
  background-image:repeating-linear-gradient(90deg,#ffd166 0 48px,#ff6aa2 48px 96px,#8be0ff 96px 144px,#a7f0c0 144px 192px);
  clip-path:polygon(0 65%,6% 0,12% 65%,18% 0,24% 65%,30% 0,36% 65%,42% 0,48% 65%,54% 0,60% 65%,66% 0,72% 65%,78% 0,84% 65%,90% 0,96% 65%,100% 0);
  filter:drop-shadow(0 6px 16px rgba(255,106,162,.25));
}

/* candle/wish */
.candle-lit{position:absolute;bottom:65%;left:50%;transform:translateX(-50%);width:20px;height:65px;border-radius:8px;background:#d73b3b;z-index:6;pointer-events:none}
.candle-lit::before{content:"";position:absolute;top:-28px;left:50%;transform:translateX(-50%);width:22px;height:35px;border-radius:50% 50% 40% 40%;background:radial-gradient(circle at 30% 30%,#ffd96a,#ffb347 40%,#ff8c00 70%);filter:blur(.6px);animation:flame 900ms infinite;box-shadow:0 0 22px rgba(255,156,40,.55)}
@keyframes flame{0%{transform:translateX(-50%) translateY(-2px) scale(1) rotate(-2deg)}50%{transform:translateX(-50%) translateY(-10px) scale(1.1) rotate(2deg)}100%{transform:translateX(-50%) translateY(-2px) scale(1) rotate(-2deg)}}
.wish{font-family:'Pacifico',cursive;font-size:clamp(24px,6vw,36px);color:#b31c6b;font-weight:600;text-align:center;text-shadow:0 8px 22px rgba(255,255,255,.9)}

/* balloons (FULL SCREEN, above fireworks) */
.balloons-stage{display:flex;flex-direction:column;align-items:center;gap:20px; position:relative}
.balloon-container{
  position:fixed; inset:0; width:100vw; height:100svh; overflow:visible;
  z-index:300; /* above fireworks (100) */
  pointer-events:auto;
}
.balloon{
  position:absolute;width:88px;height:120px;border-radius:50%;
  display:flex;align-items:center;justify-content:center;
  cursor:pointer;transition:transform .12s ease,opacity .2s;z-index:30
}
.balloon::after{content:"";position:absolute;left:50%;bottom:-14px;width:2px;height:36px;background:rgba(0,0,0,.08);transform:translateX(-50%)}
.balloon.red{background:radial-gradient(circle at 30% 30%,#ff9fbd,#ff6aa2)}
.balloon.blue{background:radial-gradient(circle at 30% 30%,#a7ecff,#5fc1e3)}
.balloon.green{background:radial-gradient(circle at 30% 30%,#bff7d0,#59c67a)}
.balloon.pop{transform:scale(1.35) rotate(-12deg);opacity:0;transition:transform .35s ease,opacity .35s}
.shine{position:absolute;width:40%;height:30%;top:12%;left:18%;background:rgba(255,255,255,.22);border-radius:50%}

/* Reveal poster (raised above everything, tappable) */
.reveal-wrap{
  position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);
  display:flex;flex-direction:column;align-items:center;gap:10px;
  width:min(92vw,720px);max-width:720px;padding:8px;
  z-index:1200; /* raised */
}
.tap-hint{font-size:16px;color:#b31c6b;margin-top:6px;margin-bottom:4px}
.after-image{
  display:block;width:100%;max-width:720px;height:auto;
  max-height:calc(100svh - 180px);object-fit:contain;border-radius:12px;
  box-shadow:0 12px 44px rgba(0,0,0,.16);transform-origin:center;
  transition:opacity .45s ease,transform .45s cubic-bezier(.2,.9,.3,1);
  opacity:0; cursor:pointer; /* tappable */
}
.reveal-wrap.visible .after-image{opacity:1; transform:scale(1)}
.reveal-wrap.hidden{display:none}

/* Album modal */
.album-modal.hidden{display:none}
.album-modal{position:fixed;inset:0;display:grid;place-items:center;padding:16px;background:var(--overlay);z-index:1300}
.album-modal.show { animation: albumIn .48s cubic-bezier(.2,.9,.22,1) both; }
.album-modal.hide { animation: albumOut .32s cubic-bezier(.3,.9,.28,1) both; }
@keyframes albumIn { 0% { opacity: 0; transform: translateY(8px) scale(.96); filter:blur(6px); }
  60% { opacity: 1; transform: translateY(-6px) scale(1.02); filter:blur(0); }
  100% { opacity: 1; transform: translateY(0) scale(1); filter:blur(0); } }
@keyframes albumOut { 0% { opacity:1; transform: translateY(0) scale(1); }
  100% { opacity:0; transform: translateY(12px) scale(.96); } }

.album-inner{
  position:relative; display:flex; flex-direction:column; gap:12px;
  width:min(920px,95vw); height:min(92svh,820px);
  background:linear-gradient(180deg,#fff,#fff8fb); border:2px dashed var(--border);
  border-radius:18px; box-shadow:0 18px 70px rgba(0,0,0,.18); padding:18px;
  overflow:hidden; align-items:center
}
.album-close{position:absolute;top:12px;right:12px;background:transparent;border:0;color:#b31c6b;font-size:22px;cursor:pointer}
.album-title{margin-top:6px;font-family:'Pacifico',cursive;font-size:clamp(20px,5.5vw,28px);color:#b31c6b;align-self:center}
.album-sub{color:#7a517f;opacity:.9;font-size:13px;align-self:center}

/* Video area */
.video-wrap{width:100%;flex:1 1 auto;display:flex;align-items:center;justify-content:center;position:relative}
.video-wrap.hidden{display:none}

/* Letterboxed video that shows the whole video (no crop) */
.video-letterbox{
  width:100%;
  max-width:920px;
  aspect-ratio:16/9;
  background:#000;
  border-radius:12px;
  display:flex;
  align-items:center;
  justify-content:center;
  overflow:hidden;
  box-shadow:0 12px 36px rgba(0,0,0,.12);
}
.album-video{
  width:100%;
  height:100%;
  object-fit:contain;
  background:#000;
  border-radius:0;
}

/* Buttons on video */
.video-play-btn{
  position:absolute; inset:auto auto max(14px, env(safe-area-inset-bottom)) 14px;
  padding:10px 14px; border-radius:999px; border:0; cursor:pointer;
  font-weight:800; color:#fff;
  background:linear-gradient(90deg,#ff6aa2,#ff7fb6);
  box-shadow:0 12px 26px rgba(255,106,162,.30); z-index:2;
}
.video-audio-btn{
  position:absolute;
  top:12px;
  left:12px;
  padding:8px 12px;
  border-radius:999px;
  border:0;
  font-weight:800;
  color:#fff;
  cursor:pointer;
  background:linear-gradient(90deg,#5ecb5e,#1fa31f);
  box-shadow:0 10px 22px rgba(31,163,31,.28);
  z-index:2;
}
.video-audio-btn[aria-pressed="true"]{
  background:linear-gradient(90deg,#888,#666);
}

/* Viewer */
.viewer{
  width:100%; flex:1 1 auto;
  background:linear-gradient(180deg,#fff,#fff9fb);
  border:1px solid #ffd5e8;border-radius:12px;
  box-shadow:0 12px 36px rgba(255,106,162,.18), inset 0 0 0 1px rgba(255,255,255,.7);
  position:relative; overflow:hidden; display:flex; align-items:center; justify-content:center
}
.viewer.hidden{display:none}
.viewer-img{max-width:100%;max-height:100%;object-fit:contain;border-radius:10px}

/* Card modal */
.card-modal.hidden{display:none}
.card-modal{position:fixed;inset:0;display:grid;place-items:center;padding:16px;background:var(--overlay);z-index:1400}

/* Card container */
.card-inner{
  width:min(700px, 96vw);
  max-height:min(92svh, 840px);
  background:var(--panel);
  border:2px dashed var(--border);
  border-radius:22px;
  box-shadow:0 18px 70px rgba(0,0,0,.18);
  padding:16px;
  position:relative;
  display:flex;
  flex-direction:column;
  gap:12px;
  overflow:hidden;
}
.album-close[aria-label="Close card"]{top:10px;right:12px;color:#b31c6b;position:absolute}

.gcard{
  position:relative;margin:0 auto;width:100%;max-width:560px;aspect-ratio:4/3;border-radius:18px;background:#fff;overflow:hidden;
  box-shadow:0 16px 50px rgba(255,106,162,.25), inset 0 0 0 1px #ffe2f0;
  transform-style:preserve-3d; perspective:1400px;
}
.gcard-front{position:absolute;inset:0;display:grid;place-items:center;background:linear-gradient(180deg,#fff,#fff8fb)}
.gcard-title{font-family:'Pacifico',cursive;font-size:clamp(28px,7vw,42px);color:#b31c6b;text-shadow:0 6px 14px rgba(255,255,255,.8)}

.gcard-inside{
  position:absolute;inset:0;padding:16px 16px 0;
  display:none;background:linear-gradient(180deg,#fff,#fff9fb);
  display:flex;flex-direction:column;overflow:auto;
  scroll-behavior:smooth;
}
.gcard.open .gcard-front{animation:frontFlipOut .55s ease forwards}
.gcard.open .gcard-inside{display:flex;animation:cardIn .55s .45s ease both}

.gcard-inside h3{margin-bottom:10px;color:#b31c6b;font-size:clamp(18px,5vw,22px)}
.gcard-inside p{margin:8px 0;color:#5a365f;line-height:1.65;font-size:clamp(14px,4.2vw,16px)}
.gcard-inside .sign{margin-top:14px;color:#8a5f93}

/* typing text box */
.typed{
  white-space:pre-wrap;
  overflow:auto;
  max-height:none;
  padding-right:6px;
  padding-bottom:70px; /* space for sticky button on phones */
}
.typed.typing::after{
  content:"";display:inline-block;width:1px;height:1em;margin-left:2px;background:#b31c6b;
  animation:blink 1s steps(1,end) infinite;
}
@keyframes blink { 50% { opacity:0; } }
.typed::-webkit-scrollbar{width:8px}
.typed::-webkit-scrollbar-thumb{background:#ffd5e8;border-radius:8px}
.typed::-webkit-scrollbar-track{background:transparent}

/* replay button always reachable */
.card-replay{
  position:sticky;
  bottom: max(10px, env(safe-area-inset-bottom));
  align-self:center;
  margin:12px 0 8px;
  z-index:1;
}

/* helpers */
.hidden{display:none}

/* Responsive tweaks */
@media (max-width:640px){
  .marquee{height:40px}
  .marquee__inner{animation-duration:22s;font-size:14px}
  .after-image{max-height: calc(100svh - 130px)}
  .album-inner{padding:12px}
}
@media (min-width:991px){
  .cake-img{width:420px}
  .ring{width:260px;height:260px}.num{font-size:110px}
}
